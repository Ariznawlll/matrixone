-- @suite
-- @case
-- @desc:test for binary datatype
-- @label:bvt

-- Test for basic syntax.
drop table if exists t1;
create table t1(a binary(2));
insert into t1 values(null);
select * from t1;
insert into t1 values("时");
select * from t1;
insert into t1 values(rpad("1", 500, "1"));
delete from t1 where a="时";
insert into t1 values("6");
insert into t1 values("66");
insert into t1 values("6");
select * from t1 where a != '6\0';
insert into t1 values("65");
select * from t1 where a > '6 ';
select * from t1 where a = '6';
select * from t1 where a = '6 ';
select cast('a' as varbinary);
SELECT CAST(TIMESTAMP "2022-01-22 21:45:33" AS BINARY(6));
select cast('12345' as binary);

DROP DATABASE IF EXISTS test;
create database test;
USE test;

-- default length 0
DROP TABLE IF EXISTS binary01;
CREATE TABLE binary01(a binary);
INSERT INTO binary01 VALUES(63872143291);
INSERT INTO binary01 VALUES(2784329432432);
DROP TABLE binary01;

-- if binary does not reach the specified length，fill 0
DROP TABLE IF EXISTS length01;
CREATE TABLE length01(col1 binary(20));
INSERT into length01 VALUES('12');
INSERT into length01 VALUES('372814');
INSERT into length01 VALUES('&***');
SELECT * FROM length01;
DROP TABLE length01;

-- the max length of binary is 255
DROP TABLE IF EXISTS length02;
CREATE TABLE length02(col1 binary(255));
INSERT into length02 VALUES('ttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttt');
INSERT into length02 VALUES('dehwjqbewbvhrbewrhebwjverguyw432843iuhfkuejwnfjewbhvbewh4gh3jbvrew vnbew rjjrewkfrhjewhrefrewfrwrewf432432r32r432r43rewvrewrfewfrewf432f43fewf4324r3r3rrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr');
SELECT * from length02;
DROP TABLE length02;

-- Test of binary and NULL
DROP TABLE IF EXISTS length03;
CREATE TABLE length03 (col1 binary(4));
INSERT INTO length03 VALUES ('a');
INSERT INTO length03 VALUES ('a ');
INSERT INTO length03 VALUES ('b');
INSERT INTO length03 VALUES ('b ');
INSERT INTO length03 VALUES (' abc');
INSERT INTO length03 VALUES (NULL);
INSERT INTO length03 VALUES (123);
INSERT INTO length03 VALUES (-90);
INSERT INTO length03 VALUES (0);
INSERT INTO length03 VALUES ('8**');
INSERT INTO length03 VALUES (' ');
SELECT * FROM length03;

-- abnormal insertion
INSERT INTO length03 VALUES ('abcde');
INSERT INTO length03 VALUES ('-902183');
INSERT INTO length03 VALUES ('123abc**');

-- sort
SELECT * FROM length03 ORDER BY col1;
SELECT * FROM length03 ORDER BY col1 DESC;

-- aggregate:max,min,count
SELECT MAX(col1) FROM length03;
SELECT MIN(col1) FROM length03;
SELECT COUNT(col1) FROM length03;

-- bitand,bitor,bitxor
SELECT BIT_AND(col1) FROM length03;
SELECT bit_or(col1) FROM length03;
SELECT bit_xor(col1) FROM length03;

DROP TABLE length03;

-- index
DROP TABLE IF EXISTS index01;
CREATE TABLE index01(col1 binary ,col2 binary(100),UNIQUE INDEX(col2));
INSERT INTO index01 VALUES('1','213dew2321');
INSERT INTO index01 VALUES('a','&^*32f3r2');
INSERT INTO index01 VALUES('%','--0-32=');
show INDEX FROM index01;
DROP TABLE index01;

-- view
DROP TABLE IF EXISTS view00;
DROP TABLE IF EXISTS view01;
CREATE TABLE view00(a binary(10));
INSERT INTO view00 VALUES(214213);
INSERT INTO view00 VALUES(-329184021);
CREATE TABLE view01(a binary(30));
INSERT INTO view01 VALUES (352183902148392104);
CREATE VIEW v0 AS SELECT view01.a, view01.a AS b FROM view00 LEFT JOIN view01 USING(a);
show CREATE v0;
show CREATE v0;
DROP view v0;
show CREATE v0;
DROP TABLE view00;
DROP TABLE view01;

-- cte
DROP TABLE IF EXISTS cte01;
CREATE TABLE cte01(col1 int, col2 binary(10),col3 varbinary(20));
INSERT INTO cte01 VALUES(1,03921094321,'32432121421');
INSERT INTO cte01 VALUES(2,000000,'&&&*(*');
INSERT INTO cte01 VALUES(1,'$%^&',38921432);
SELECT * FROM cte01;
WITH cte_1 AS(SELECT col1,col2 FROM cte01 WHERE col1 = 1) SELECT col2 FROM cte_1 WHERE col2 = 0x33393231303934333231;
WITH cte_2 AS(SELECT col1,col3 FROM cte01 WHERE col1 = 2) SELECT col3 FROM cte_2 WHERE col3 = 0x2626262A282A;
DROP TABLE cte01;

-- aggregate
DROP TABLE IF EXISTS bit01;
CREATE TABLE bit01(id char(1), b binary(10));
INSERT INTO bit01 VALUES('a', '111');
INSERT INTO bit01 VALUES('a', '110');
INSERT INTO bit01 VALUES('a', '143');
INSERT INTO bit01 VALUES('a', '000');
INSERT INTO bit01 VALUES('b', '001');
INSERT INTO bit01 VALUES('b', '011');
INSERT INTO bit01 VALUES('c', '010');
INSERT INTO bit01 VALUES('d', NULL);
SELECT * FROM bit01;

-- bit_and,bit_or,bit_xor
SELECT id, BIT_AND(b) FROM bit01 GROUP by id;
SELECT id, bit_or(b) FROM Bit01 GROUP by id;
SELECT id, bit_xor(b) FROM bit01 GROUP by id;

-- order by
SELECT * FROM bit01 ORDER BY b DESC;
SELECT * FROM bit01 ORDER BY b;

-- any_value
SELECT id, any_value(b) FROM bit01 group by id;

-- group_concat
SELECT id, group_concat(id,b) FROM bit01 group by id;

-- where,between and,not between and,=,!=,in,not in,>,>=,<,<=,COALESCE
SELECT hex(b) FROM bit01;
SELECT hex(b) FROM bit01 WHERE hex(b) = 31313100000000000000;
SELECT * FROM bit01 WHERE CAST(id AS binary) = 0x61;
SELECT * FROM bit01 WHERE CAST(id AS binary) != 0x61;
SELECT * FROM bit01 WHERE b BETWEEN 0x30303000000000000000 AND 0x30313100000000000000;
SELECT * FROM bit01 WHERE b NOT BETWEEN 0x30303000000000000000 AND 0x30313100000000000000;
SELECT hex(b) FROM bit01 WHERE b IN(0x30303000000000000000);
SELECT * FROM bit01 WHERE b NOT IN(0x30303000000000000000);
SELECT * FROM bit01 WHERE b > 0x31313000000000000000;
SELECT hex(b) FROM bit01 WHERE b >= 0x31313000000000000000;
SELECT * FROM bit01 WHERE b < 0x31303000000000000000;
SELECT hex(b) FROM bit01 WHERE b <= 0x31303000000000000000;
SELECT * FROM bit01 WHERE b is NULL;
SELECT * FROM bit01 WHERE b is not NULL;
SELECT COALESCE(NULL,NULL,b) FROM bit01;

-- subquery
SELECT hex(b) FROM bit01 WHERE id = (SELECT id FROM bit01 WHERE b = 0x31313100000000000000);
DROP TABLE bit01;

-- insert into select
DROP TABLE IF EXISTS t3;
CREATE TABLE t3(id char(1), b binary(10));
INSERT INTO t3 SELECT * FROM bit01;
SELECT * FROM t3;

-- update and delete
UPDATE bit01 SET b = 101 WHERE id = 'c';
DELETE FROM bit01 WHERE id = 'c';
DROP TABLE t3;

-- cast from non-binary to binary
SELECT CAST("A" AS binary) = "a";
SELECT CAST("z" AS binary);
SELECT CAST(12 AS binary);
SELECT CAST(NULL AS binary);
SELECT CAST("*" AS binary(30));
SELECT CAST(0101010 AS binary);
SELECT CAST(-10 AS binary(20));
SELECT CAST(0 AS binary);
SELECT CAST('9' AS binary);
SELECT CAST(9 AS binary);
SELECT CAST(-9090.999 AS binary);
SELECT CAST('1232142' AS binary(10));
SELECT CAST(27832.2213213211321432 AS binary);
SELECT CAST(-38921.3423 AS binary);
SELECT CAST(' ' AS binary(10));
SELECT CAST('' AS binary(10));
SELECT CAST(FALSE AS binary);
SELECT CAST(TRUE AS binary(10));
SELECT CAST(NULL AS binary(4));

SELECT CAST('@#$$%%' AS binary);
SELECT CAST('26713hajncjdncekfwr' AS binary);
SELECT CAST('-3902=3-21-3' AS binary);
SELECT CAST(2913812 AS binary(1));
SELECT CAST(100 AS binary(1));
SELECT CAST('3672817438921' AS binary(2));
SELECT CAST(37218738243.32142 AS binary(100));
SELECT CAST('数据库' AS binary(10));
SELECT CAST('数据库mo&*' AS binary);

-- hex,cast
DROP TABLE IF EXISTS cast01;
CREATE TABLE cast01(a binary(10), b CHAR, c bigint);
INSERT INTO cast01 VALUES('3214243','0', -9);
INSERT INTO cast01 VALUES('-1212','1', 8989);
INSERT INTO cast01 VALUES(NULL, 'e', 45318424324324);
SELECT * FROM cast01;
SELECT hex(a),hex(b) FROM cast01;
SELECT CAST(b AS binary) FROM cast01;
SELECT CAST(c AS binary) FROM cast01;
SELECT * FROM cast01 WHERE a != '1212';
SELECT * FROM cast01 WHERE a = '-1212';
SELECT * FROM cast01 WHERE a is NULL;
SELECT * FROM cast01 WHERE a is NOT NULL;
DROP TABLE IF EXISTS cast02;
CREATE TABLE cast02(col1 binary(10), col2 binary(20), col3 binary(30));
INSERT into cast02 SELECT * from cast01;
SELECT * from cast02;
DROP TABLE cast01;
DROP TABLE cast02;

DROP TABLE IF EXISTS cast03;
CREATE TABLE cast03(a int NOT NULL PRIMARY KEY, b float, c double, d VARCHAR(30),e decimal(20,10));
INSERT INTO cast03 VALUES(1, 3214321.213, -8392.3,'woshishei',123456789.12356);
INSERT INTO cast03 VALUES(2, 0, 38293.3332121,'12345@',-12.365);
INSERT INTO cast03 VALUES(3, -392.1, 8390232,'3***',0.456984166622488655);
DROP table IF EXISTS cast04;

CREATE TABLE cast04 (col1 binary(10), col2 varbinary(20), col3 varbinary(20),col4 binary(30),col5 varbinary(30));
INSERT into cast04 SELECT * from cast03;
drop table cast04;
SELECT CAST(a AS binary) FROM cast03;

-- @bvt:issue#8719
SELECT CAST(b AS binary) FROM cast03;
-- @bvt:issue

SELECT CAST(c as binary) FROM cast03;
SELECT CAST(e as binary) FROM cast03;

SELECT CAST(d AS binary) FROM cast03;
DROP TABLE cast03;

-- cast date,datetime,timestamp,time to binary
SELECT CAST(DATE "2023-01-13" AS binary(10));
SELECT CAST('08:00:00' AS binary(10));
SELECT CAST('2019-03-05 01:53:55.63' AS binary(200));
SELECT CAST(TIMESTAMP "2004-01-22 21:45:33" AS BINARY(4));

-- implicit conversion：date、datetime、timestamp、time
DROP TABLE IF EXISTS time01;
DROP TABLE IF EXISTS time02;
CREATE TABLE time01(col1 date,col2 datetime,col3 TIMESTAMP,col4 TIME);
INSERT INTO time01 VALUES("2020-01-01","2019-01-01 00:00:00","1999-01-01 00:00:01","08:00:00");
INSERT INTO time01 VALUES("2022-01-01","1996-01-01 23:23:23","2023-09-12 20:45:06","00:00:00");
INSERT INTO time01 VALUES("1997-01-13",NULL,"2024-01-01 00:00:01",NULL);
CREATE TABLE time02(col1 binary,col2 binary(10),col3 binary(2),col4 binary(10));
INSERT INTO time02 SELECT * FROM time01;
DROP TABLE time01;

-- group by
DROP TABLE IF EXISTS groupby01;
CREATE TABLE groupby01(col1 tinyint unsigned, col2 binary(10) NOT NULL);
INSERT INTO groupby01 VALUES(0, '2312432112');
INSERT INTO groupby01 VALUES(20, '321313');
INSERT INTO groupby01 VALUES(23, '2312432112');
INSERT INTO groupby01 VALUES(255, '321313');
SELECT col2,bit_and(col1) FROM groupby01 GROUP BY col2;
SELECT col2,bit_xor(col1) FROM groupby01 GROUP BY col2;
SELECT col2,bit_or(col1) FROM groupby01 GROUP BY col2;
DROP TABLE groupby01;

-- test of external table
DROP table IF EXISTS external01;
CREATE external table external01(clo1 binary,clo2 bigint)infile{"filepath"='$resources/external_table_file/aaa.csv'};
SELECT * FROM external01;
drop table external01;

-- test of temporary table
DROP TABLE IF EXISTS temporary01;
CREATE TEMPORARY table temporary01(col1 binary, col2 float, col3 double);
INSERT into temporary01 values(NULL,38232424.3242,90090);
INSERT into temporary01 values('123',NULL,'3829043294.3242432');
INSERT into temporary01 values('0',0.123233333333,7894646541.4547845412);

-- @bvt:issue#8719
SELECT CAST(col1 AS binary) FROM temporary01;
SELECT CAST(col2 AS binary) FROM temporary01;
SELECT CAST(col3 AS binary) FROM temporary01;
-- @bvt:issue
drop table temporary01;

-- join
DROP TABLE IF EXISTS join01;
DROP TABLE IF EXISTS join02;
CREATE TABLE join01(col1 binary,col2 varbinary(65535),col3 bigint unsigned);
INSERT INTO join01 VALUES('a','7894531e234r323r2844352r432r4',78965612184651);
INSERT INTO join01 VALUES('b',NULL,5463137456315300);
INSERT INTO join01 VALUES('c',0121313131,0);
SELECT * FROM join01;

CREATE TABLE join02(col1 binary,col2 varbinary(65535));
INSERT INTO join02 VALUES('a','7894531e234r323r2844352r432r4');
INSERT INTO join02 VALUES('b',NULL);
INSERT INTO join02 VALUES('d',012131);
SELECT * FROM join02;

SELECT join01.col1,join02.col2 FROM join01,join02 WHERE join01.col1 = join02.col1;
SELECT join01.col1,join02.col2 FROM join01 left join join02 on join01.col1 = join02.col1;
SELECT join01.col1,join02.col2 FROM join01 right join join02 on join01.col1 != join02.col1;
SELECT join01.col1,join02.col2 FROM join01 inner join join02 on join01.col1 = join02.col1;
DROP TABLE join01;
DROP TABLE join02;

-- builtin function
DROP table IF EXISTS built01;
CREATE TABLE built01 (col1 binary,col2 varbinary(10),col3 VARCHAR(20));
INSERT into built01 VALUES('a',85555555,'372r4973892ufd3jf432');
INSERT into built01 VALUES('b',NULL,'3e8729fj32i4f3f435');
INSERT into built01 VALUES('c',0,null);
INSERT into built01 VALUES('d',   73281482,'326784921-3kfi');
INSERT into built01 VALUES('e', 3782949432 ,' ');
SELECT bit_length(col2) FROM built01;
SELECT bit_length(col1) FROM built01;
SELECT length(col1) FROM built01;
SELECT length(col2) FROM built01;
SELECT LTRIM(col2) FROM built01;
SELECT RTRIM(col2) FROM built01;
SELECT substring(col1,1,4) FROM built01;
SELECT CONCAT_WS(col1,'string',col2) FROM built01;
SELECT CHAR_length(col1) FROM built01;
SELECT char_length(col2) FROM built01;
SELECT REVERSE(col2) FROM built01;
SELECT startswith(col2,85) FROM built01;
SELECT endswith(col2,32 )FROM built01;

-- @bvt:issue#8760
SELECT CONCAT(col1,col2) FROM built01;
-- @bvt:issue

-- @bvt:issue#8761
SELECT RPAD(col1,100,"fewqf43f3g54") FROM built01;
SELECT LPAD(col2,10,"xxxxxxxxxxx") FROM built01;
-- @bvt:issue
DROP TABLE built01;

-- varbinary test
-- default length test
DROP TABLE IF EXISTS binary01;
CREATE TABLE varbinary01(a varbinary);
INSERT INTO varbinary01 VALUES(63872143291);
INSERT INTO varbinary01 VALUES(2784329432432);
DROP TABLE varbinary01;

-- test of varbinary
DROP TABLE IF EXISTS varbinary01;
CREATE TABLE varbinary01 (
  a varbinary(20) NOT NULL DEFAULT '\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0',
  index idx(a)
);
INSERT INTO varbinary01 SET a=hex('A');
INSERT INTO varbinary01 SET a=hex('1F9');
INSERT INTO varbinary01 SET a=hex('80707');
INSERT INTO varbinary01 VALUES('  12  ');
INSERT INTO varbinary01 VALUES('abc** ');
INSERT INTO varbinary01 VALUES('-12321');
INSERT INTO varbinary01 VALUES(2121432432143212121);

-- varbinary:abnormal insertion
INSERT INTO varbinary01 VALUES(NULL);
INSERT INTO varbinary01 VALUES(2121432432143212132312121);
INSERT INTO varbinary01 VALUES('chabvkjewnjrklf rewmfrewfew');
SELECT * FROM varbinary01;

-- sort
SELECT * FROM varbinary01 ORDER BY a;
SELECT * FROM varbinary01 ORDER BY a DESC;

-- aggregate:max,min
SELECT max(a) FROM varbinary01;
SELECT min(a) FROM varbinary01;
DROP TABLE varbinary01;

-- varbinary:aggregate: bit_and,bit_or,bit_xor,any_value,group_concat
DROP TABLE IF EXISTS varbinary02;
CREATE TABLE varbinary02 (
  col1 int, col2 varbinary(20) NOT NULL,
  index idx(col2)
);

INSERT INTO varbinary02 VALUES(1, '11111111101010101');
INSERT INTO varbinary02 VALUES(2, '10111111101010101');
INSERT INTO varbinary02 VALUES(1, '36217468721382183');
INSERT INTO varbinary02 VALUES(2, '22258445222388855');
INSERT INTO varbinary02 VALUES(2, '00000000000000000');
SELECT * FROM varbinary02;

SELECT * FROM varbinary02 order by col2 ASC;
SELECT BIT_AND(col2) FROM varbinary02;
SELECT BIT_OR(col2) FROM varbinary02;
SELECT BIT_XOR(col2) FROM varbinary02;
SELECT col1, BIT_AND(col2) FROM varbinary02 group by col1;
SELECT col1, BIT_OR(col2) FROM varbinary02 group by col1;
SELECT col1, any_value(col2) FROM varbinary02 group by col1;
SELECT col1, group_concat(col1,col2) FROM varbinary02 group by col1;
SELECT col1, hex(col2) FROM varbinary02;

-- where,between,not between,=,!=,in,not in,subquery,>,>=,<,<=
SELECT * FROM varbinary02 WHERE col2 = 11111111101010101;
SELECT * FROM varbinary02 WHERE col2 != 11111111101010101;
SELECT * FROM varbinary02 WHERE col2 BETWEEN 0x3131313131313131313031303130313031 AND 0x3336323137343638373231333832313833;
SELECT * FROM varbinary02 WHERE col2 NOT BETWEEN 0x3131313131313131313031303130313031 AND 0x3336323137343638373231333832313833;
SELECT * FROM varbinary02 WHERE col2 IN(0x3131313131313131313031303130313031,0x3336323137343638373231333832313833);
SELECT * FROM varbinary02 WHERE col2 NOT IN(0x3131313131313131313031303130313031,0x3336323137343638373231333832313833);
SELECT * FROM varbinary02 WHERE col2 != (SELECT col2 FROM varbinary02 WHERE col2 = 11111111101010101);
SELECT * FROM varbinary02 WHERE col2 LIKE '0x313131313131313131303130313031303%';
SELECT * FROM varbinary02 WHERE col2 LIKE 0x3131313131313131313031303130313031;
SELECT * FROM varbinary02 WHERE col2 > 0x3131313131313131313031303130313031;
SELECT * FROM varbinary02 WHERE col2 >=0x3131313131313131313031303130313031;
SELECT * FROM varbinary02 WHERE col2 < 0x3131313131313131313031303130313031;
SELECT * FROM varbinary02 WHERE col2 <= 0x3131313131313131313031303130313031;
SELECT COALESCE(NULL,NULL,col2) FROM varbinary02;
DROP TABLE varbinary02;

-- insert into select
DROP TABLE IF EXISTS varbinary03;
CREATE TABLE varbinary03(col1 int unsigned, col2 varbinary(10));
INSERT INTO varbinary03 VALUES(1, '121212');
INSERT INTO varbinary03 VALUES(2, '-12431');
INSERT INTO varbinary03 VALUES(3, NULL);

DROP TABLE IF EXISTS varbinary04;
CREATE TABLE varbinary04(col1 int unsigned, col2 varbinary(10));
INSERT INTO varbinary04 SELECT * FROM varbinary03;
SELECT * FROM varbinary04;
SELECT COALESCE(null,col2) FROM varbinary03;
DROP TABLE varbinary03;
DROP TABLE varbinary04;

-- cast
SELECT CAST("A" AS varbinary(100)) = "a";
SELECT CAST(37218738243.32142 AS varbinary(100));
SELECT CAST("z" AS varbinary(10));
SELECT CAST(12 AS varbinary(20));
SELECT CAST("*" AS varbinary(1));
SELECT CAST(-10 AS varbinary(20));
SELECT CAST(0 AS varbinary(100));
SELECT CAST(9 AS varbinary(10));
SELECT CAST(-9090.999 AS varbinary(100));
SELECT CAST(27832.2213213211321432 AS varbinary(65535));
SELECT CAST(-38921.3423 AS varbinary(10));
SELECT CAST(' ' AS varbinary(20));
SELECT CAST('' AS varbinary(10));

SELECT CAST('@#$$%%' AS varbinary(1));
SELECT CAST('26713hajncjdncekfwr' AS varbinary(1));
SELECT CAST('-3902=3-21-3' AS varbinary(1));
SELECT CAST(2913812 AS varbinary(1));
SELECT CAST(100 AS varbinary(1));
SELECT CAST('3672817438921' AS varbinary(2));
SELECT CAST(37218738243.32142 AS varbinary(100));
SELECT CAST(0101010 AS varbinary(1));
SELECT CAST('数据库' AS varbinary(10));
SELECT CAST('数据库mo&*' AS binary(10));

-- abnormal test: no length specified
SELECT CAST("z" AS varbinary);
SELECT CAST(12 AS varbinary);
SELECT CAST(NULL AS varbinary);
SELECT CAST("*" AS varbinary);
SELECT CAST(0101010 AS varbinary);
SELECT CAST(-10 AS varbinary);
SELECT CAST(0 AS varbinary);
SELECT CAST('9' AS varbinary);
SELECT CAST(9 AS varbinary);
SELECT CAST(-9090.999 AS varbinary);
SELECT CAST(27832.2213213211321432 AS varbinary);
SELECT CAST(-38921.3423 AS varbinary);
SELECT CAST('anfdjasv' AS varbinary);
SELECT CAST('efhkjw21231' AS varbinary);

-- cast
DROP TABLE IF EXISTS varbinary05;
CREATE TABLE varbinary05(a varbinary(30), b CHAR, c bigint);
INSERT INTO varbinary05 VALUES('3214243','0', -9);
INSERT INTO varbinary05 VALUES('-1212','1', 8989);
INSERT INTO varbinary05 VALUES(NULL, 'e', 45318424324324);
SELECT * FROM varbinary05;
SELECT hex(a),hex(b) FROM varbinary05;
SELECT CAST(b AS binary) FROM varbinary05;
SELECT CAST(c AS binary) FROM varbinary05;
DROP TABLE varbinary05;

DROP TABLE IF EXISTS varbinary06;
CREATE TABLE varbinary06(a int NOT NULL PRIMARY KEY, b float, c double, d VARCHAR(30),e decimal(20,10));
INSERT INTO varbinary06 VALUES(1, 3214321.213, -8392.3,'woshishei',123456789.12356);
INSERT INTO varbinary06 VALUES(2, 0, 38293.3332121,'12345@',-12.365);
INSERT INTO varbinary06 VALUES(3, -392.1, 8390232,'3***',0.456984166622488655);

SELECT CAST(a AS varbinary(10)) FROM varbinary06;
-- @bvt:issue#8719
SELECT CAST(b AS varbinary(100)) FROM varbinary06;
-- @bvt:issue
SELECT CAST(c AS varbinary(20)) FROM varbinary06;
SELECT CAST(d AS varbinary(30)) FROM varbinary06;
SELECT CAST(e AS varbinary(100)) FROM varbinary06;
DROP TABLE varbinary06;

-- the max length of varbinary is 65535
DROP TABLE IF EXISTS varbinary07;
CREATE TABLE varbinary07(col1 varbinary(65535));
DROP TABLE varbinary07;

DROP TABLE IF EXISTS varbinary08;
CREATE TABLE varbinary08(col1 varbinary(65536));
DROP TABLE varbinary08;

-- cast date、time、timestamp、datetime to varbinary
SELECT CAST(DATE "2023-01-13" AS varbinary(10));
SELECT CAST('08:00:00' AS varbinary(100));
SELECT CAST('2019-03-05 01:53:55.63' AS varbinary(200));

SELECT CAST(TIMESTAMP "2004-01-22 21:45:33" AS BINARY(4));
SELECT CAST(DATE "2023-01-13" AS varbinary(2));

-- test of external table
DROP table IF EXISTS varbinary09;
CREATE external table varbinary09(clo1 varbinary(60),clo2 bigint)infile{"filepath"='$resources/external_table_file/aaa.csv'};
SELECT * FROM varbinary09;
drop table varbinary09;

-- test of temporary table
DROP TABLE IF EXISTS varbinary10;
CREATE TEMPORARY table varbinary09(col1 varbinary(60), col2 float, col3 double);
INSERT into varbinary09 values(NULL,38232424.3242,90090);
INSERT into varbinary09 values('123',NULL,'3829043294.3242432');
INSERT into varbinary09 values('0',0.123233333333,7894646541.4547845412);

-- @bvt:issue#8719
SELECT CAST(col1 AS varbinary(100)) FROM varbinary09;
SELECT CAST(col2 AS varbinary(100)) FROM varbinary09;
SELECT CAST(col3 AS varbinary(10)) FROM varbinary09;
-- @bvt:issue
drop table varbinary09;

-- foreign key
DROP TABLE IF EXISTS varbinary10;
DROP TABLE IF EXISTS varbinary11;
create table varbinary10(a binary primary key,b varchar(5));
create table varbinary11(a int,b varchar(5),c binary, foreign key(c) references varbinary10(a));
INSERT into varbinary10 VALUES('1','哈哈哈');
INSERT into varbinary10 VALUES('1','abcde');
show CREATE TABLE varbinary11;
DROP TABLE varbinary11;
DROP TABLE varbinary10;

-- join
DROP TABLE IF EXISTS varbinary12;
DROP TABLE IF EXISTS varbinary13;
CREATE TABLE varbinary12(col1 binary,col2 varbinary(65535),col3 bigint unsigned);
INSERT INTO varbinary12 VALUES('a','7894531e234r323r2844352r432r4',78965612184651);
INSERT INTO varbinary12 VALUES('b',NULL,5463137456315300);
INSERT INTO varbinary12 VALUES('c',0121313131,0);
SELECT * FROM varbinary12;

CREATE TABLE varbinary13(col1 binary,col2 varbinary(65535));
INSERT INTO varbinary13 VALUES('a','7894531e234r323r2844352r432r4');
INSERT INTO varbinary13 VALUES('b',NULL);
INSERT INTO varbinary13 VALUES('d',012131);
SELECT * FROM varbinary13;

SELECT varbinary12.col1,varbinary13.col2 FROM varbinary12,varbinary13 WHERE varbinary12.col2 = varbinary13.col2;
SELECT varbinary12.col1,varbinary13.col2 FROM varbinary12 left join varbinary13 on varbinary12.col2 = varbinary13.col2;
SELECT varbinary12.col1,varbinary13.col2 FROM varbinary12 right join varbinary13 on varbinary12.col2 != varbinary13.col2;
SELECT varbinary12.col1,varbinary13.col2 FROM varbinary12 inner join varbinary13 on varbinary12.col2 = varbinary13.col2;
SELECT varbinary12.col1,varbinary13.col2 FROM varbinary12 natural join varbinary13;
DROP TABLE varbinary12;
DROP TABLE varbinary13;

-- text
drop TABLE IF EXISTS text_01;
create table text_01(t1 text,t2 text,t3 text);
insert into text_01 values ('中文123abcd','',NULL);
insert into text_01 values ('yef&&190',' wwww ',983);
insert into text_01 select '',null,'中文';
insert into text_01 select '123','7834','commmmmmment';
insert into text_01 values ('789',' 23:50:00','20');
select * from text_01;
SELECT CAST(t1 AS binary(20)) FROM text_01;
SELECT CAST(t2 AS binary(100)) FROM text_01;
SELECT CAST(t1 AS varbinary(20)) FROM text_01;
SELECT CAST(t2 AS varbinary(100)) FROM text_01;

SELECT CAST(t3 AS varbinary(1)) FROM text_01;
SELECT CAST(t3 AS binary) FROM text_01;
DROP TABLE text_01;

-- blob
drop TABLE IF EXISTS blob_01;
create table blob_01(b1 blob,b2 blob,b3 blob);
insert into blob_01 values ('no','中文','89233432234234 ');
insert into blob_01 values ('',' hhhh@126.com','0001-01-01');
insert into blob_01 values ('#$%^&*()',NULL,null);
select * from blob_01;

SELECT CAST(b1 AS varbinary(20)) FROM blob_01;
SELECT CAST(b2 AS varbinary(100)) FROM blob_01;
SELECT CAST(b1 AS binary(20)) FROM blob_01;
SELECT CAST(b2 AS binary(100)) FROM blob_01;

SELECT CAST(b3 AS varbinary(1)) FROM blob_01;
SELECT CAST(b3 AS binary) FROM blob_01;
DROP TABLE blob_01;

-- prepare
drop table if EXISTS prepare01;
create table prepare01 (a binary(20), b varbinary(100));
insert into prepare01 values (12.2222, '3278492142324');
prepare stmt1 from 'update prepare01 set a=?';
set @bin_a=0.1111;
execute stmt1 using @bin_a;
-- @bvt:issue#8790
select a, b from prepare01;
-- @bvt:issue
prepare stmt2 from 'insert into prepare01 values(NULL,0)';
execute stmt2;
SELECT * from prepare01;
drop TABLE prepare01;

-- select binary
select binary(372817432918321);
select binary(0823109213);
select binary('1');
select binary(NULL);
select binary(' ');
select binary('&**');

select binary('数据库');
select binary('hello你好呀');
DROP DATABASE test;