SELECT median(1);
median(1)
1.0
SELECT median(0);
median(0)
0.0
SELECT median(2424.1);
median(2424.1)
2424.1
SELECT median(54150.4841612);
median(54150.4841612)
54150.4841612
SELECT median(-328);
median(-328)
-328.0
SELECT median(-6372.2);
median(-6372.2)
-6372.2
SELECT median(NULL);
median(null)
null
SELECT median(ABS(-99));
median(abs(-99))
99.0
SELECT median(COS(0) + 2);
median(cos(0) + 2)
3.0
SELECT median(1,2,3);
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 16 near ",2,3);";
SELECT median(fekwelwfew);
invalid input: column fekwelwfew does not exist
SELECT median(3hewh32ioj);
invalid input: column 3hewh32ioj does not exist
SELECT median("ejwjlvd23232r43f");
invalid argument aggregate function median, bad value [VARCHAR]
SELECT median("4");
invalid argument aggregate function median, bad value [VARCHAR]
DROP TABLE IF EXISTS test;
CREATE TABLE test(id int, d1 tinyint, d2 smallint unsigned, d3 bigint);
INSERT INTO test VALUES(1, -128, 65534, 5554584122);
INSERT INTO test VALUES(2, 0, 68, -7855122);
INSERT INTO test VALUES(3, 45, 0, 67432648932);
INSERT INTO test VALUES(4, 45, 5789, 0);
INSERT INTO test VALUES(5, NULL, 3782, NULL);
INSERT INTO test VALUES(6, -129, 65534, 5554584122);
truncated type TINYINT value -129 for column d1, 1
INSERT INTO test VALUES(7, -123, 89555, 5554584122);
truncated type SMALLINT UNSIGNED value 89555 for column d2, 1
INSERT INTO test VALUES(8, -62, 33, 9223372036854775808);
truncated type BIGINT value 9223372036854775808 for column d3, 1
INSERT INTO test VALUES(2147483648, -62, 33, 9223372036854775808);
truncated type INT value 2147483648 for column id, 1
SELECT median(d2) from test;
median(d2)
3782.0
SELECT median(d1),median(d2),median(d3),median(id) from test;
median(d1)    median(d2)    median(d3)    median(id)
22.5    3782.0    2.777292061E9    3.0
SELECT median(d1) + median(d2) as dd from test where id = 2;
dd
68.0
SELECT median(d3) FROM test WHERE id BETWEEN 1 AND 4;
median(d3)
2.777292061E9
SELECT median(d1),median(d2),median(d3) from test GROUP by d1;
median(d1)    median(d2)    median(d3)
-128.0    65534.0    5.554584122E9
0.0    68.0    -7855122.0
45.0    2894.5    3.3716324466E10
null    3782.0    null
SELECT median(d1) FROM test WHERE id = ABS(-1) + TAN(45);
median(d1)
null
DROP TABLE IF EXISTS test;
CREATE TABLE test(id int PRIMARY KEY, d1 FLOAT, d2 DOUBLE NOT NULL);
INSERT INTO test VALUES(1, 645545.11, 65534.5554584122);
INSERT INTO test VALUES(2, NULL, 638239.1);
INSERT INTO test VALUES(3, -32783, -56323298.8327382);
INSERT INTO test VALUES(4, 0, 389283920.1);
INSERT INTO test VALUES(5, 382, 0);
INSERT INTO test VALUES(6, 0, -1.8976931348623157E+308);
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 54 near "1.8976931348623157E+308);";
INSERT INTO test VALUES(7, 4.402823466351E+38, 5554584122);
truncated type FLOAT value 4.402823466351e+38 for column d1, 1
INSERT INTO test VALUES(8, -55845.0, NULL);
constraint violation: Column 'd2' cannot be null
SELECT median(d1), median(d2) from test;
median(d1)    median(d2)
191.0    65534.5554584122
SELECT median(d2) from test group by d2;
median(d2)
65534.5554584122
638239.1
-5.63232988327382E7
3.892839201E8
0.0
SELECT median(d2) from test WHERE id BETWEEN 2 AND 4;
median(d2)
638239.1
SELECT median(d1) from test WHERE id = (SELECT id from test where d2 = 65534.5554584122);
median(d1)
645545.125
DROP TABLE IF EXISTS test;
DROP TABLE IF EXISTS test1;
CREATE TABLE test(id int, ch smallint NOT NULL, ma bigint unsigned NOT NULL, en FLOAT, ph double,
PRIMARY KEY(id));
INSERT INTO test VALUES(1, 88, 99999, -99.98, 88.99);
INSERT INTO test VALUES(2, 65, 744515, 0, 78.789);
INSERT INTO test VALUES(3, 76, 21, 893293.1, NULL);
INSERT INTO test VALUES(4, -367, 3298, NULL, 0);
INSERT INTO test VALUES(5, 674, 432, 8767687.0, 0.1);
CREATE TABLE test1(id int, name VARCHAR(10), ch smallint, ma bigint, en FLOAT not NULL,
PRIMARY KEY(id));
INSERT INTO test1 VALUES(1, 'Alice', 327, 45451, 3232.1);
INSERT INTO test1 VALUES(2, 'Bob', 3728, -8889, 899);
INSERT INTO test1 VALUES(3, 'Grace', 0, NULL, 0.1);
INSERT INTO test1 VALUES(4, 'Vicky', 88, 99, 88888.0);
INSERT INTO test1 VALUES(5, 'John', 10, 23211, -78);
SELECT median(test1.ch) from test, test1 where test.id = test1.id;
median(test1.ch)
88.0
SELECT median(test.ma) AS a, median(test1.ma) AS b from test join test1 ON test.ph = test1.en;
a    b
null    null
SELECT median(test.ch),median(test.en) from test WHERE id % 2 =1;
median(test.ch)    median(test.en)
88.0    893293.125
SELECT median(test1.ch) from test1 WHERE left(name,2) = 'Al';
median(test1.ch)
327.0
